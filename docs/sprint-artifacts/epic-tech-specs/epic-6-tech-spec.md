# Epic 6: Accessibility & Quality - Technical Specification

**Epic ID:** 6
**Epic Title:** Accessibility & Quality
**Date:** 2025-12-01
**Author:** Generated by Epic Tech Context Specialist

---

## 1. Epic Overview

### 1.1 Description

Epic 6 delivers full WCAG 2.1 AA compliance, performance optimization, and quality refinements that make AI Obituaries accessible to all users regardless of ability or device constraints. This epic transforms the site from "works for most" to "works for everyone" - ensuring keyboard-only users, screen reader users, users with visual impairments, and users who experience motion sensitivity can fully experience the archive.

The core focus areas are:
- **Keyboard Navigation:** Full site operability without a mouse
- **Screen Reader Support:** ARIA landmarks, labels, and live regions for assistive technology
- **Alternative Table View:** Non-visual access to timeline data
- **Visual Accessibility:** Color contrast, focus indicators, and high contrast mode
- **Reduced Motion:** Respecting `prefers-reduced-motion` preference
- **Performance:** Core Web Vitals compliance and 60fps interactions

### 1.2 Business Value and Goals

- **Legal Compliance:** WCAG 2.1 AA is increasingly required for public-facing sites
- **Broader Reach:** 15-20% of users have some form of disability
- **SEO Benefits:** Accessibility improvements often improve search rankings
- **User Experience:** Accessibility features benefit all users (keyboard power users, mobile users, etc.)
- **Credibility:** A data-driven archive should be accessible to all researchers and journalists
- **Performance:** Fast loading times improve engagement and reduce bounce rates

### 1.3 Functional Requirements Covered

| FR ID | Requirement | Story |
|-------|-------------|-------|
| FR38 | Site meets WCAG 2.1 AA compliance standards | 6-7 |
| FR39 | All interactive elements are keyboard navigable | 6-1 |
| FR40 | Timeline is fully keyboard accessible | 6-2 |
| FR41 | Screen readers can access all timeline data | 6-3 |
| FR42 | System provides alternative table view of timeline data | 6-4 |
| FR43 | All images have appropriate alt text | 6-3, 6-7 |
| FR44 | Color contrast meets 4.5:1 minimum ratio | 6-5 |
| FR45 | Pages load within acceptable performance thresholds | 6-8 |
| FR46 | Timeline renders smoothly without jank during interaction | 6-8 |
| FR47 | Animations run at 60fps | 6-6, 6-8 |

### 1.4 Scope

**In-Scope (8 Stories):**
- Story 6-1: Keyboard Navigation Foundation (global keyboard patterns)
- Story 6-2: Timeline Keyboard Access (scatter plot navigation)
- Story 6-3: Screen Reader Support (ARIA implementation)
- Story 6-4: Alternative Table View (accessible data table)
- Story 6-5: Color Contrast and Visual Accessibility
- Story 6-6: Reduced Motion Support (prefers-reduced-motion)
- Story 6-7: WCAG Compliance Audit (testing and fixes)
- Story 6-8: Performance Optimization (Core Web Vitals)

**Out-of-Scope:**
- WCAG 2.1 AAA compliance (targets AA)
- Voice navigation / voice control
- Cognitive accessibility beyond WCAG AA requirements
- Internationalization / localization (separate epic)
- Print stylesheet optimization

### 1.5 Dependencies and Prerequisites

**Epic Dependencies:**
- Epic 1 complete (Foundation)
  - shadcn/ui components (accessibility primitives)
  - Tailwind CSS with design tokens
- Epic 2 complete (Core Content Display)
  - Obituary pages with structured content
  - SEO foundation with semantic HTML
- Epic 3 complete (Timeline Visualization)
  - ScatterPlot component with interactions
  - Tooltip and modal patterns
- Epic 4 complete (Category System)
  - Filter components
  - URL state with nuqs
- Epic 5 complete (Navigation)
  - Mobile hybrid view
  - Breadcrumbs and navigation

**External Dependencies:**
- axe-core / @axe-core/playwright (accessibility testing)
- Lighthouse CI (performance testing)
- NVDA/VoiceOver (manual screen reader testing)

---

## 2. Technical Context

### 2.1 Relevant Architecture Decisions

| ADR | Decision | Impact on Epic 6 |
|-----|----------|------------------|
| - | shadcn/ui components | Built on Radix UI with accessibility primitives |
| - | Visx visualization | SVG-based, accessible to screen readers |
| - | Motion animation | Supports reduced motion preference |
| - | Server Components | Semantic HTML rendered server-side |

### 2.2 WCAG 2.1 AA Requirements Overview

| Principle | Guidelines | Epic 6 Coverage |
|-----------|------------|-----------------|
| **Perceivable** | 1.1 Text Alternatives, 1.3 Adaptable, 1.4 Distinguishable | 6-3, 6-4, 6-5 |
| **Operable** | 2.1 Keyboard Accessible, 2.2 Enough Time, 2.4 Navigable | 6-1, 6-2 |
| **Understandable** | 3.1 Readable, 3.2 Predictable, 3.3 Input Assistance | 6-3, 6-7 |
| **Robust** | 4.1 Compatible | 6-3, 6-7 |

### 2.3 Technology Stack for Epic 6

| Technology | Version | Purpose in Epic 6 |
|------------|---------|-------------------|
| @axe-core/playwright | 4.x | Automated a11y testing |
| focus-visible | Polyfill | Keyboard focus detection |
| Motion | 12.9.x | prefers-reduced-motion support |
| Lighthouse | CI | Performance metrics |
| React ARIA | Patterns | ARIA patterns reference |

### 2.4 Project Structure (Epic 6 Additions)

```
src/
├── app/
│   ├── page.tsx                      # Modify: Add table view toggle
│   ├── globals.css                   # Modify: Focus styles, reduced motion
│   └── obituary/
│       └── [slug]/
│           └── page.tsx              # Modify: Enhanced a11y attributes
│
├── components/
│   ├── accessibility/
│   │   ├── skip-link.tsx             # Create: Skip to main content
│   │   ├── focus-trap.tsx            # Create: Modal focus management
│   │   ├── live-region.tsx           # Create: Screen reader announcements
│   │   └── visually-hidden.tsx       # Create: SR-only content
│   │
│   ├── obituary/
│   │   ├── obituary-table.tsx        # Create: Accessible table view
│   │   └── table-view-toggle.tsx     # Create: Toggle between views
│   │
│   ├── visualization/
│   │   ├── scatter-plot.tsx          # Modify: Keyboard nav, ARIA
│   │   ├── scatter-point.tsx         # Modify: Focus management
│   │   └── tooltip-card.tsx          # Modify: aria-describedby
│   │
│   └── ui/
│       └── sheet.tsx                 # Modify: Focus trap, announcements
│
├── lib/
│   ├── hooks/
│   │   ├── use-reduced-motion.ts     # Create: Motion preference hook
│   │   ├── use-focus-trap.ts         # Create: Focus trap hook
│   │   └── use-roving-focus.ts       # Create: Grid navigation
│   │
│   └── utils/
│       └── a11y.ts                   # Create: Accessibility utilities
│
└── tests/
    ├── a11y/                         # Create: Accessibility test suite
    │   ├── axe.spec.ts               # Automated axe testing
    │   ├── keyboard.spec.ts          # Keyboard navigation tests
    │   └── screen-reader.spec.ts     # Screen reader scenarios
    │
    └── performance/                  # Create: Performance test suite
        └── lighthouse.spec.ts        # Lighthouse CI tests
```

---

## 3. Data Models

### 3.1 Accessibility State Types

```typescript
// src/types/accessibility.ts

/**
 * View mode for timeline data display.
 */
export type TimelineViewMode = 'visualization' | 'table'

/**
 * Keyboard navigation direction.
 */
export type NavigationDirection = 'up' | 'down' | 'left' | 'right' | 'home' | 'end'

/**
 * Focus state for roving tabindex pattern.
 */
export interface RovingFocusState {
  /** Currently focused item index */
  focusedIndex: number
  /** Total number of items */
  itemCount: number
  /** Grid columns (for 2D navigation) */
  columns?: number
}

/**
 * Live region announcement.
 */
export interface Announcement {
  /** Unique ID for the announcement */
  id: string
  /** Text to announce */
  message: string
  /** Politeness level */
  politeness: 'polite' | 'assertive'
  /** Optional delay before announcement */
  delay?: number
}

/**
 * Color contrast check result.
 */
export interface ContrastResult {
  /** Foreground color */
  foreground: string
  /** Background color */
  background: string
  /** Calculated contrast ratio */
  ratio: number
  /** Passes AA for normal text (4.5:1) */
  passesAA: boolean
  /** Passes AA for large text (3:1) */
  passesAALarge: boolean
}
```

### 3.2 Table View Data Structure

```typescript
// src/types/obituary.ts (extension)

/**
 * Obituary data formatted for table display.
 */
export interface ObituaryTableRow {
  /** Unique ID */
  id: string
  /** Link to detail page */
  slug: string
  /** Publication date (formatted) */
  date: string
  /** Date for sorting (ISO) */
  dateISO: string
  /** Source name */
  source: string
  /** Claim text (truncated) */
  claim: string
  /** Primary category */
  category: Category
  /** All categories */
  categories: Category[]
}

/**
 * Table sort configuration.
 */
export interface TableSortConfig {
  /** Column to sort by */
  column: 'date' | 'source' | 'category'
  /** Sort direction */
  direction: 'asc' | 'desc'
}
```

---

## 4. Component Specifications

### 4.1 Story 6-1: Keyboard Navigation Foundation

#### Component: SkipLink

**File:** `src/components/accessibility/skip-link.tsx`

```typescript
'use client'

interface SkipLinkProps {
  /** Target element ID */
  targetId?: string
  /** Link text */
  children?: React.ReactNode
}

export function SkipLink({
  targetId = 'main-content',
  children = 'Skip to main content'
}: SkipLinkProps) {
  return (
    <a
      href={`#${targetId}`}
      className="
        sr-only focus:not-sr-only
        focus:fixed focus:top-4 focus:left-4 focus:z-[100]
        focus:px-4 focus:py-2 focus:rounded-lg
        focus:bg-[--accent-primary] focus:text-[--bg-primary]
        focus:font-medium focus:outline-none focus:ring-2 focus:ring-offset-2
        focus:ring-[--accent-primary]
      "
      onClick={(e) => {
        e.preventDefault()
        const target = document.getElementById(targetId)
        if (target) {
          target.focus()
          target.scrollIntoView({ behavior: 'smooth' })
        }
      }}
    >
      {children}
    </a>
  )
}
```

#### Root Layout Integration

**File:** `src/app/layout.tsx` (modification)

```typescript
import { SkipLink } from '@/components/accessibility/skip-link'

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <SkipLink />
        <Header />
        <main id="main-content" tabIndex={-1} className="outline-none">
          {children}
        </main>
        <Footer />
      </body>
    </html>
  )
}
```

#### Focus Indicator Styles

**File:** `src/app/globals.css` (additions)

```css
/* Focus Visible Styles */
:focus-visible {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
}

/* Remove default outline for mouse users */
:focus:not(:focus-visible) {
  outline: none;
}

/* Interactive element focus states */
button:focus-visible,
a:focus-visible,
[role="button"]:focus-visible,
[tabindex="0"]:focus-visible {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
  border-radius: 4px;
}

/* Input focus states */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 2px solid var(--accent-primary);
  outline-offset: 0;
  border-color: var(--accent-primary);
}

/* High contrast mode support */
@media (forced-colors: active) {
  :focus-visible {
    outline: 3px solid CanvasText;
  }
}
```

#### Keyboard Handler Utility

**File:** `src/lib/utils/a11y.ts`

```typescript
/**
 * Handle common keyboard interactions.
 */
export function handleKeyboardNavigation(
  event: React.KeyboardEvent,
  handlers: {
    onEnter?: () => void
    onSpace?: () => void
    onEscape?: () => void
    onArrowUp?: () => void
    onArrowDown?: () => void
    onArrowLeft?: () => void
    onArrowRight?: () => void
    onHome?: () => void
    onEnd?: () => void
    onTab?: () => void
  }
) {
  const { key } = event

  switch (key) {
    case 'Enter':
      if (handlers.onEnter) {
        event.preventDefault()
        handlers.onEnter()
      }
      break
    case ' ':
      if (handlers.onSpace) {
        event.preventDefault()
        handlers.onSpace()
      }
      break
    case 'Escape':
      if (handlers.onEscape) {
        event.preventDefault()
        handlers.onEscape()
      }
      break
    case 'ArrowUp':
      if (handlers.onArrowUp) {
        event.preventDefault()
        handlers.onArrowUp()
      }
      break
    case 'ArrowDown':
      if (handlers.onArrowDown) {
        event.preventDefault()
        handlers.onArrowDown()
      }
      break
    case 'ArrowLeft':
      if (handlers.onArrowLeft) {
        event.preventDefault()
        handlers.onArrowLeft()
      }
      break
    case 'ArrowRight':
      if (handlers.onArrowRight) {
        event.preventDefault()
        handlers.onArrowRight()
      }
      break
    case 'Home':
      if (handlers.onHome) {
        event.preventDefault()
        handlers.onHome()
      }
      break
    case 'End':
      if (handlers.onEnd) {
        event.preventDefault()
        handlers.onEnd()
      }
      break
    case 'Tab':
      if (handlers.onTab) {
        handlers.onTab()
      }
      break
  }
}

/**
 * Generate unique ID for ARIA relationships.
 */
let idCounter = 0
export function generateId(prefix: string = 'a11y'): string {
  return `${prefix}-${++idCounter}`
}

/**
 * Check if an element is visible and focusable.
 */
export function isFocusable(element: Element): boolean {
  if (!(element instanceof HTMLElement)) return false

  // Check if hidden
  if (element.hidden || element.getAttribute('aria-hidden') === 'true') {
    return false
  }

  // Check computed style
  const style = window.getComputedStyle(element)
  if (style.display === 'none' || style.visibility === 'hidden') {
    return false
  }

  // Check tabindex
  const tabindex = element.getAttribute('tabindex')
  if (tabindex && parseInt(tabindex) < 0) {
    return false
  }

  // Check if inherently focusable
  const focusableTags = ['A', 'BUTTON', 'INPUT', 'SELECT', 'TEXTAREA']
  if (focusableTags.includes(element.tagName)) {
    return !(element as HTMLButtonElement).disabled
  }

  // Check for explicit tabindex
  return tabindex !== null
}

/**
 * Get all focusable elements within a container.
 */
export function getFocusableElements(container: HTMLElement): HTMLElement[] {
  const selector = [
    'a[href]',
    'button:not([disabled])',
    'input:not([disabled])',
    'select:not([disabled])',
    'textarea:not([disabled])',
    '[tabindex]:not([tabindex="-1"])',
    '[contenteditable]'
  ].join(',')

  return Array.from(container.querySelectorAll<HTMLElement>(selector))
    .filter(isFocusable)
}
```

**Acceptance Criteria:**
1. Skip link appears on keyboard focus (Tab)
2. Skip link jumps to main content when activated
3. All interactive elements have visible focus indicators
4. Focus indicators use gold accent color
5. Focus ring has 2px offset from element
6. Focus works in high contrast mode

### 4.2 Story 6-2: Timeline Keyboard Access

#### Hook: useRovingFocus

**File:** `src/lib/hooks/use-roving-focus.ts`

```typescript
'use client'

import { useCallback, useState, useRef, useEffect } from 'react'
import type { NavigationDirection } from '@/types/accessibility'

interface UseRovingFocusOptions {
  /** Total number of items */
  itemCount: number
  /** Grid columns for 2D navigation (optional) */
  columns?: number
  /** Callback when focus changes */
  onFocusChange?: (index: number) => void
  /** Initial focused index */
  initialIndex?: number
  /** Wrap around at boundaries */
  wrap?: boolean
}

interface UseRovingFocusReturn {
  /** Currently focused index */
  focusedIndex: number
  /** Get tabindex for an item */
  getTabIndex: (index: number) => 0 | -1
  /** Handle keyboard navigation */
  handleKeyDown: (event: React.KeyboardEvent, itemIndex: number) => void
  /** Set focus to specific index */
  setFocusedIndex: (index: number) => void
  /** Ref callback for items */
  getItemRef: (index: number) => (el: HTMLElement | null) => void
}

export function useRovingFocus({
  itemCount,
  columns,
  onFocusChange,
  initialIndex = 0,
  wrap = true
}: UseRovingFocusOptions): UseRovingFocusReturn {
  const [focusedIndex, setFocusedIndex] = useState(initialIndex)
  const itemRefs = useRef<(HTMLElement | null)[]>([])

  // Update refs array size
  useEffect(() => {
    itemRefs.current = itemRefs.current.slice(0, itemCount)
  }, [itemCount])

  const getTabIndex = useCallback((index: number): 0 | -1 => {
    return index === focusedIndex ? 0 : -1
  }, [focusedIndex])

  const moveFocus = useCallback((direction: NavigationDirection) => {
    let newIndex = focusedIndex

    switch (direction) {
      case 'left':
        newIndex = focusedIndex - 1
        if (wrap && newIndex < 0) newIndex = itemCount - 1
        break
      case 'right':
        newIndex = focusedIndex + 1
        if (wrap && newIndex >= itemCount) newIndex = 0
        break
      case 'up':
        if (columns) {
          newIndex = focusedIndex - columns
          if (wrap && newIndex < 0) {
            // Wrap to last row
            const lastRowStart = Math.floor((itemCount - 1) / columns) * columns
            newIndex = Math.min(lastRowStart + (focusedIndex % columns), itemCount - 1)
          }
        }
        break
      case 'down':
        if (columns) {
          newIndex = focusedIndex + columns
          if (newIndex >= itemCount && wrap) {
            // Wrap to first row
            newIndex = focusedIndex % columns
          }
        }
        break
      case 'home':
        newIndex = 0
        break
      case 'end':
        newIndex = itemCount - 1
        break
    }

    // Clamp to valid range
    newIndex = Math.max(0, Math.min(newIndex, itemCount - 1))

    if (newIndex !== focusedIndex) {
      setFocusedIndex(newIndex)
      onFocusChange?.(newIndex)
      // Focus the element
      itemRefs.current[newIndex]?.focus()
    }
  }, [focusedIndex, itemCount, columns, wrap, onFocusChange])

  const handleKeyDown = useCallback((event: React.KeyboardEvent, itemIndex: number) => {
    // Update focused index if clicking into a different item
    if (itemIndex !== focusedIndex) {
      setFocusedIndex(itemIndex)
    }

    switch (event.key) {
      case 'ArrowLeft':
        event.preventDefault()
        moveFocus('left')
        break
      case 'ArrowRight':
        event.preventDefault()
        moveFocus('right')
        break
      case 'ArrowUp':
        event.preventDefault()
        moveFocus('up')
        break
      case 'ArrowDown':
        event.preventDefault()
        moveFocus('down')
        break
      case 'Home':
        event.preventDefault()
        moveFocus('home')
        break
      case 'End':
        event.preventDefault()
        moveFocus('end')
        break
    }
  }, [focusedIndex, moveFocus])

  const getItemRef = useCallback((index: number) => {
    return (el: HTMLElement | null) => {
      itemRefs.current[index] = el
    }
  }, [])

  return {
    focusedIndex,
    getTabIndex,
    handleKeyDown,
    setFocusedIndex,
    getItemRef
  }
}
```

#### ScatterPlot Keyboard Enhancement

**File:** `src/components/visualization/scatter-plot.tsx` (modification)

```typescript
// Add to existing ScatterPlot component:

import { useRovingFocus } from '@/lib/hooks/use-roving-focus'

export function ScatterPlot({ data, activeCategories, onPointSelect }: ScatterPlotProps) {
  // ... existing state and logic ...

  // Sort data by date for consistent navigation order
  const sortedData = useMemo(() =>
    [...data].sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime()),
    [data]
  )

  // Filter data based on active categories
  const visibleData = useMemo(() =>
    sortedData.filter(ob =>
      activeCategories.length === 0 ||
      ob.categories.some(c => activeCategories.includes(c))
    ),
    [sortedData, activeCategories]
  )

  // Roving focus for keyboard navigation
  const {
    focusedIndex,
    getTabIndex,
    handleKeyDown,
    getItemRef
  } = useRovingFocus({
    itemCount: visibleData.length,
    onFocusChange: (index) => {
      // Center the focused point in view
      const point = visibleData[index]
      if (point) {
        scrollToPoint(point)
      }
    }
  })

  // Live region for announcements
  const [announcement, setAnnouncement] = useState('')

  return (
    <div
      role="application"
      aria-label="Timeline visualization. Use arrow keys to navigate between obituaries."
      className="relative"
    >
      {/* Live region for screen reader announcements */}
      <div
        role="status"
        aria-live="polite"
        aria-atomic="true"
        className="sr-only"
      >
        {announcement}
      </div>

      {/* Navigation instructions (visible on focus) */}
      <div className="sr-only" id="timeline-instructions">
        Press left and right arrow keys to navigate between obituaries.
        Press Enter or Space to view details.
        Press Home to go to first obituary, End to go to last.
      </div>

      <svg
        role="group"
        aria-describedby="timeline-instructions"
        aria-label={`Timeline showing ${visibleData.length} obituaries`}
        // ... existing SVG props ...
      >
        {/* Axis and other elements... */}

        {/* Data points with keyboard support */}
        <g role="list" aria-label="Obituary data points">
          {visibleData.map((obituary, index) => (
            <ScatterPoint
              key={obituary._id}
              obituary={obituary}
              ref={getItemRef(index)}
              tabIndex={getTabIndex(index)}
              isFocused={index === focusedIndex}
              onKeyDown={(e) => {
                handleKeyDown(e, index)
                if (e.key === 'Enter' || e.key === ' ') {
                  e.preventDefault()
                  onPointSelect?.(obituary)
                  setAnnouncement(`Opening details for ${obituary.source}, ${obituary.claim.slice(0, 50)}...`)
                }
              }}
              onFocus={() => {
                setAnnouncement(
                  `${index + 1} of ${visibleData.length}. ${obituary.source}. ` +
                  `${new Date(obituary.date).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}. ` +
                  `${obituary.claim.slice(0, 100)}...`
                )
              }}
              // ... existing props ...
            />
          ))}
        </g>
      </svg>
    </div>
  )
}
```

#### ScatterPoint Accessibility Enhancement

**File:** `src/components/visualization/scatter-point.tsx` (modification)

```typescript
import { forwardRef } from 'react'

interface ScatterPointProps {
  obituary: Obituary
  x: number
  y: number
  tabIndex: 0 | -1
  isFocused: boolean
  onKeyDown: (e: React.KeyboardEvent) => void
  onFocus: () => void
  onClick: () => void
  onHover: (ob: Obituary | null) => void
  isFiltered: boolean
}

export const ScatterPoint = forwardRef<SVGGElement, ScatterPointProps>(
  function ScatterPoint({
    obituary,
    x,
    y,
    tabIndex,
    isFocused,
    onKeyDown,
    onFocus,
    onClick,
    onHover,
    isFiltered
  }, ref) {
    const pointId = `point-${obituary._id}`
    const descriptionId = `desc-${obituary._id}`

    return (
      <g
        ref={ref}
        role="listitem"
        tabIndex={tabIndex}
        aria-labelledby={pointId}
        aria-describedby={descriptionId}
        onKeyDown={onKeyDown}
        onFocus={onFocus}
        onClick={onClick}
        onMouseEnter={() => onHover(obituary)}
        onMouseLeave={() => onHover(null)}
        className={cn(
          "cursor-pointer outline-none",
          isFiltered && "opacity-20 pointer-events-none"
        )}
        style={{ transform: `translate(${x}px, ${y}px)` }}
      >
        {/* Screen reader text */}
        <title id={pointId}>
          {obituary.source} - {new Date(obituary.date).toLocaleDateString()}
        </title>
        <desc id={descriptionId}>
          {obituary.claim.slice(0, 150)}...
          Category: {obituary.categories.join(', ')}
        </desc>

        {/* Visual point */}
        <circle
          r={isFocused ? 10 : 8}
          className={cn(
            "transition-all duration-150",
            CATEGORY_COLORS[obituary.categories[0] || 'dismissive'],
            isFocused && "stroke-[--accent-primary] stroke-2"
          )}
        />

        {/* Focus ring */}
        {isFocused && (
          <circle
            r={14}
            fill="none"
            stroke="var(--accent-primary)"
            strokeWidth={2}
            strokeDasharray="4 2"
            className="animate-pulse"
          />
        )}
      </g>
    )
  }
)
```

**Acceptance Criteria:**
1. Tab into timeline focuses first visible point
2. Arrow keys navigate between points (left/right for chronological)
3. Enter/Space opens obituary modal
4. Home/End jump to first/last point
5. Focus indicator visible around active point
6. Screen reader announces current point details on focus
7. Instructions available for screen readers

### 4.3 Story 6-3: Screen Reader Support

#### Component: LiveRegion

**File:** `src/components/accessibility/live-region.tsx`

```typescript
'use client'

import { createContext, useContext, useCallback, useState, useRef, useEffect } from 'react'
import type { Announcement } from '@/types/accessibility'

interface LiveRegionContextValue {
  announce: (message: string, politeness?: 'polite' | 'assertive') => void
  announcePolite: (message: string) => void
  announceAssertive: (message: string) => void
}

const LiveRegionContext = createContext<LiveRegionContextValue | null>(null)

export function useLiveRegion() {
  const context = useContext(LiveRegionContext)
  if (!context) {
    throw new Error('useLiveRegion must be used within a LiveRegionProvider')
  }
  return context
}

export function LiveRegionProvider({ children }: { children: React.ReactNode }) {
  const [politeMessage, setPoliteMessage] = useState('')
  const [assertiveMessage, setAssertiveMessage] = useState('')
  const clearTimeoutRef = useRef<NodeJS.Timeout>()

  const announce = useCallback((message: string, politeness: 'polite' | 'assertive' = 'polite') => {
    // Clear previous timeout
    if (clearTimeoutRef.current) {
      clearTimeout(clearTimeoutRef.current)
    }

    if (politeness === 'assertive') {
      setAssertiveMessage(message)
    } else {
      setPoliteMessage(message)
    }

    // Clear after announcement
    clearTimeoutRef.current = setTimeout(() => {
      setPoliteMessage('')
      setAssertiveMessage('')
    }, 1000)
  }, [])

  const announcePolite = useCallback((message: string) => {
    announce(message, 'polite')
  }, [announce])

  const announceAssertive = useCallback((message: string) => {
    announce(message, 'assertive')
  }, [announce])

  return (
    <LiveRegionContext.Provider value={{ announce, announcePolite, announceAssertive }}>
      {children}

      {/* Polite live region */}
      <div
        role="status"
        aria-live="polite"
        aria-atomic="true"
        className="sr-only"
      >
        {politeMessage}
      </div>

      {/* Assertive live region */}
      <div
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        className="sr-only"
      >
        {assertiveMessage}
      </div>
    </LiveRegionContext.Provider>
  )
}
```

#### Component: VisuallyHidden

**File:** `src/components/accessibility/visually-hidden.tsx`

```typescript
interface VisuallyHiddenProps {
  children: React.ReactNode
  /** Render as a specific element */
  as?: 'span' | 'div' | 'p' | 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6'
}

export function VisuallyHidden({ children, as: Component = 'span' }: VisuallyHiddenProps) {
  return (
    <Component className="sr-only">
      {children}
    </Component>
  )
}
```

#### ARIA Landmarks Enhancement

**File:** `src/app/layout.tsx` (modification)

```typescript
export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <LiveRegionProvider>
          <SkipLink />
          <SkipLink targetId="timeline" aria-label="Skip to timeline">
            Skip to timeline
          </SkipLink>

          <Header role="banner" />

          <main
            id="main-content"
            role="main"
            tabIndex={-1}
            className="outline-none"
          >
            {children}
          </main>

          <Footer role="contentinfo" />
        </LiveRegionProvider>
      </body>
    </html>
  )
}
```

#### Modal ARIA Enhancement

**File:** `src/components/obituary/obituary-modal.tsx` (modification)

```typescript
// Enhance Sheet usage with ARIA attributes

export function ObituaryModal({ obituary, isOpen, onClose, side = 'right' }: Props) {
  const titleId = `modal-title-${obituary?._id}`
  const descriptionId = `modal-desc-${obituary?._id}`

  return (
    <Sheet open={isOpen} onOpenChange={(open) => !open && onClose()}>
      <SheetContent
        side={side}
        aria-labelledby={titleId}
        aria-describedby={descriptionId}
        aria-modal="true"
        role="dialog"
        onOpenAutoFocus={(e) => {
          e.preventDefault()
          // Focus the close button or first interactive element
          const closeButton = e.currentTarget.querySelector('[data-close]')
          if (closeButton instanceof HTMLElement) {
            closeButton.focus()
          }
        }}
        onCloseAutoFocus={(e) => {
          e.preventDefault()
          // Return focus to the trigger element
        }}
      >
        <SheetHeader>
          <SheetTitle id={titleId}>
            {obituary?.source}
          </SheetTitle>
          <SheetDescription id={descriptionId} className="sr-only">
            Obituary details from {obituary?.source} dated {obituary?.date}
          </SheetDescription>
        </SheetHeader>

        {/* Modal content */}
        <div className="mt-4 space-y-4">
          <blockquote
            className="text-lg italic text-[--text-primary] border-l-4 border-[--accent-primary] pl-4"
            aria-label="The claim"
          >
            {obituary?.claim}
          </blockquote>

          {/* Context with ARIA */}
          <section aria-labelledby="context-heading">
            <h3 id="context-heading" className="font-medium mb-2">
              Context at the time
            </h3>
            <ObituaryContext context={obituary?.context} />
          </section>
        </div>

        {/* Close button with data attribute for focus management */}
        <SheetClose data-close asChild>
          <Button variant="ghost" className="absolute top-4 right-4">
            <span className="sr-only">Close</span>
            <XIcon aria-hidden="true" />
          </Button>
        </SheetClose>
      </SheetContent>
    </Sheet>
  )
}
```

**Acceptance Criteria:**
1. Page has proper ARIA landmarks (banner, main, contentinfo)
2. Interactive regions have descriptive labels
3. Modal dialogs have aria-modal and proper focus management
4. Live regions announce dynamic content changes
5. Form controls have associated labels
6. Status messages announced to screen readers
7. Navigation regions properly labeled

### 4.4 Story 6-4: Alternative Table View

#### Component: ObituaryTable

**File:** `src/components/obituary/obituary-table.tsx`

```typescript
'use client'

import { useState, useMemo } from 'react'
import Link from 'next/link'
import { format } from 'date-fns'
import { ArrowUpIcon, ArrowDownIcon } from 'lucide-react'
import type { Obituary, Category } from '@/types/obituary'
import type { TableSortConfig } from '@/types/accessibility'
import { cn } from '@/lib/utils/cn'
import { CategoryBadge } from '@/components/filters/category-pill'

interface ObituaryTableProps {
  obituaries: Obituary[]
  activeCategories: Category[]
}

export function ObituaryTable({ obituaries, activeCategories }: ObituaryTableProps) {
  const [sortConfig, setSortConfig] = useState<TableSortConfig>({
    column: 'date',
    direction: 'desc'
  })

  // Filter and sort data
  const displayData = useMemo(() => {
    let filtered = obituaries

    // Apply category filter
    if (activeCategories.length > 0) {
      filtered = obituaries.filter(ob =>
        ob.categories.some(c => activeCategories.includes(c))
      )
    }

    // Sort
    return [...filtered].sort((a, b) => {
      const multiplier = sortConfig.direction === 'asc' ? 1 : -1

      switch (sortConfig.column) {
        case 'date':
          return multiplier * (new Date(a.date).getTime() - new Date(b.date).getTime())
        case 'source':
          return multiplier * a.source.localeCompare(b.source)
        case 'category':
          return multiplier * (a.categories[0] || '').localeCompare(b.categories[0] || '')
        default:
          return 0
      }
    })
  }, [obituaries, activeCategories, sortConfig])

  const toggleSort = (column: TableSortConfig['column']) => {
    setSortConfig(prev => ({
      column,
      direction: prev.column === column && prev.direction === 'desc' ? 'asc' : 'desc'
    }))
  }

  const SortButton = ({
    column,
    children
  }: {
    column: TableSortConfig['column']
    children: React.ReactNode
  }) => (
    <button
      onClick={() => toggleSort(column)}
      className="flex items-center gap-1 font-medium hover:text-[--accent-primary] transition-colors"
      aria-sort={
        sortConfig.column === column
          ? sortConfig.direction === 'asc'
            ? 'ascending'
            : 'descending'
          : 'none'
      }
    >
      {children}
      {sortConfig.column === column && (
        sortConfig.direction === 'asc'
          ? <ArrowUpIcon className="w-4 h-4" aria-hidden="true" />
          : <ArrowDownIcon className="w-4 h-4" aria-hidden="true" />
      )}
    </button>
  )

  return (
    <div className="overflow-x-auto">
      <table
        className="w-full text-left border-collapse"
        aria-label="List of AI obituaries"
        role="grid"
      >
        <caption className="sr-only">
          AI Obituaries sorted by {sortConfig.column} in {sortConfig.direction} order.
          {activeCategories.length > 0 && ` Filtered to show ${activeCategories.join(', ')} categories.`}
        </caption>

        <thead>
          <tr className="border-b border-[--border]">
            <th scope="col" className="py-3 px-4 text-[--text-secondary]">
              <SortButton column="date">Date</SortButton>
            </th>
            <th scope="col" className="py-3 px-4 text-[--text-secondary]">
              <SortButton column="source">Source</SortButton>
            </th>
            <th scope="col" className="py-3 px-4 text-[--text-secondary]">
              Claim
            </th>
            <th scope="col" className="py-3 px-4 text-[--text-secondary]">
              <SortButton column="category">Category</SortButton>
            </th>
            <th scope="col" className="py-3 px-4 text-[--text-secondary]">
              <span className="sr-only">Actions</span>
            </th>
          </tr>
        </thead>

        <tbody>
          {displayData.length === 0 ? (
            <tr>
              <td colSpan={5} className="py-8 text-center text-[--text-muted]">
                No obituaries match the selected filters.
              </td>
            </tr>
          ) : (
            displayData.map((obituary, index) => (
              <tr
                key={obituary._id}
                className={cn(
                  "border-b border-[--border] hover:bg-[--bg-tertiary] transition-colors",
                  index % 2 === 0 && "bg-[--bg-secondary]/50"
                )}
              >
                <td className="py-3 px-4 whitespace-nowrap">
                  <time dateTime={obituary.date}>
                    {format(new Date(obituary.date), 'MMM d, yyyy')}
                  </time>
                </td>
                <td className="py-3 px-4">
                  <a
                    href={obituary.sourceUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-[--accent-primary] hover:underline"
                  >
                    {obituary.source}
                    <span className="sr-only"> (opens in new tab)</span>
                  </a>
                </td>
                <td className="py-3 px-4 max-w-md">
                  <p className="line-clamp-2">
                    {obituary.claim}
                  </p>
                </td>
                <td className="py-3 px-4">
                  <div className="flex flex-wrap gap-1">
                    {obituary.categories.map(cat => (
                      <CategoryBadge key={cat} category={cat} />
                    ))}
                  </div>
                </td>
                <td className="py-3 px-4">
                  <Link
                    href={`/obituary/${obituary.slug}`}
                    className="text-sm text-[--accent-primary] hover:underline"
                  >
                    View details
                    <span className="sr-only"> for {obituary.source} obituary</span>
                  </Link>
                </td>
              </tr>
            ))
          )}
        </tbody>

        <tfoot>
          <tr>
            <td colSpan={5} className="py-3 px-4 text-[--text-muted] text-sm">
              Showing {displayData.length} of {obituaries.length} obituaries
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  )
}
```

#### Component: TableViewToggle

**File:** `src/components/obituary/table-view-toggle.tsx`

```typescript
'use client'

import { TableIcon, ChartScatterIcon } from 'lucide-react'
import { cn } from '@/lib/utils/cn'
import type { TimelineViewMode } from '@/types/accessibility'

interface TableViewToggleProps {
  mode: TimelineViewMode
  onModeChange: (mode: TimelineViewMode) => void
}

export function TableViewToggle({ mode, onModeChange }: TableViewToggleProps) {
  return (
    <div
      role="group"
      aria-label="View mode"
      className="inline-flex rounded-lg border border-[--border] p-1"
    >
      <button
        onClick={() => onModeChange('visualization')}
        className={cn(
          "flex items-center gap-2 px-3 py-1.5 rounded-md text-sm transition-colors",
          mode === 'visualization'
            ? "bg-[--accent-primary] text-[--bg-primary]"
            : "text-[--text-secondary] hover:text-[--text-primary]"
        )}
        aria-pressed={mode === 'visualization'}
      >
        <ChartScatterIcon className="w-4 h-4" aria-hidden="true" />
        <span>Timeline</span>
      </button>
      <button
        onClick={() => onModeChange('table')}
        className={cn(
          "flex items-center gap-2 px-3 py-1.5 rounded-md text-sm transition-colors",
          mode === 'table'
            ? "bg-[--accent-primary] text-[--bg-primary]"
            : "text-[--text-secondary] hover:text-[--text-primary]"
        )}
        aria-pressed={mode === 'table'}
      >
        <TableIcon className="w-4 h-4" aria-hidden="true" />
        <span>Table</span>
      </button>
    </div>
  )
}
```

#### Homepage Integration

**File:** `src/app/page.tsx` (modification)

```typescript
'use client'

import { useState } from 'react'
import { ScatterPlot } from '@/components/visualization/scatter-plot'
import { ObituaryTable } from '@/components/obituary/obituary-table'
import { TableViewToggle } from '@/components/obituary/table-view-toggle'
import type { TimelineViewMode } from '@/types/accessibility'

export function HomeClient({ obituaries, activeCategories }: Props) {
  const [viewMode, setViewMode] = useState<TimelineViewMode>('visualization')

  return (
    <div className="flex flex-col gap-4">
      {/* View mode toggle */}
      <div className="flex justify-end px-4">
        <TableViewToggle mode={viewMode} onModeChange={setViewMode} />
      </div>

      {/* Conditional view */}
      {viewMode === 'visualization' ? (
        <ScatterPlot
          data={obituaries}
          activeCategories={activeCategories}
        />
      ) : (
        <ObituaryTable
          obituaries={obituaries}
          activeCategories={activeCategories}
        />
      )}
    </div>
  )
}
```

**Acceptance Criteria:**
1. Toggle button switches between timeline and table view
2. Table shows all obituary data in accessible format
3. Table has sortable columns (date, source, category)
4. Table has proper ARIA attributes (grid role, scope)
5. Sort state announced to screen readers
6. Row count announced in caption
7. Filter state applied to table view
8. Links to detail pages work from table

### 4.5 Story 6-5: Color Contrast and Visual Accessibility

#### Contrast Verification

**File:** `src/lib/utils/color-contrast.ts`

```typescript
/**
 * Calculate relative luminance of a color.
 * @see https://www.w3.org/TR/WCAG21/#dfn-relative-luminance
 */
export function getRelativeLuminance(r: number, g: number, b: number): number {
  const [rs, gs, bs] = [r, g, b].map(c => {
    c = c / 255
    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4)
  })
  return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs
}

/**
 * Calculate contrast ratio between two colors.
 * @see https://www.w3.org/TR/WCAG21/#dfn-contrast-ratio
 */
export function getContrastRatio(
  fg: { r: number; g: number; b: number },
  bg: { r: number; g: number; b: number }
): number {
  const l1 = getRelativeLuminance(fg.r, fg.g, fg.b)
  const l2 = getRelativeLuminance(bg.r, bg.g, bg.b)
  const lighter = Math.max(l1, l2)
  const darker = Math.min(l1, l2)
  return (lighter + 0.05) / (darker + 0.05)
}

/**
 * Parse hex color to RGB.
 */
export function hexToRgb(hex: string): { r: number; g: number; b: number } {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)
  if (!result) throw new Error(`Invalid hex color: ${hex}`)
  return {
    r: parseInt(result[1], 16),
    g: parseInt(result[2], 16),
    b: parseInt(result[3], 16)
  }
}

/**
 * Check WCAG AA compliance.
 */
export function checkWCAGAA(fgHex: string, bgHex: string): ContrastResult {
  const fg = hexToRgb(fgHex)
  const bg = hexToRgb(bgHex)
  const ratio = getContrastRatio(fg, bg)

  return {
    foreground: fgHex,
    background: bgHex,
    ratio: Math.round(ratio * 100) / 100,
    passesAA: ratio >= 4.5,
    passesAALarge: ratio >= 3
  }
}

// Project color verification
export const COLOR_CHECKS = {
  textOnBg: checkWCAGAA('#E8E6E3', '#0C0C0F'),       // 14.5:1 PASS
  secondaryOnBg: checkWCAGAA('#A8A5A0', '#0C0C0F'), // 7.2:1 PASS
  accentOnBg: checkWCAGAA('#C9A962', '#0C0C0F'),   // 7.8:1 PASS
  textOnCard: checkWCAGAA('#E8E6E3', '#18181F'),    // 12.8:1 PASS
  accentOnCard: checkWCAGAA('#C9A962', '#18181F'),  // 6.9:1 PASS
  // Category colors on dark background
  capability: checkWCAGAA('#C9A962', '#0C0C0F'),   // Gold - 7.8:1 PASS
  market: checkWCAGAA('#7B9E89', '#0C0C0F'),       // Sage - 5.8:1 PASS
  agi: checkWCAGAA('#9E7B7B', '#0C0C0F'),          // Rose - 5.0:1 PASS
  dismissive: checkWCAGAA('#7B7B9E', '#0C0C0F'),   // Lavender - 5.0:1 PASS
}
```

#### Enhanced Category Colors

**File:** `src/lib/utils/category.ts` (modification)

```typescript
// Updated category colors with better contrast
export const CATEGORY_COLORS: Record<Category, { bg: string; text: string; border: string }> = {
  capability: {
    bg: 'bg-[#C9A962]/20',
    text: 'text-[#C9A962]',
    border: 'border-[#C9A962]'
  },
  market: {
    bg: 'bg-[#7B9E89]/20',
    text: 'text-[#8AB49A]', // Lightened for better contrast
    border: 'border-[#7B9E89]'
  },
  agi: {
    bg: 'bg-[#9E7B7B]/20',
    text: 'text-[#B48A8A]', // Lightened for better contrast
    border: 'border-[#9E7B7B]'
  },
  dismissive: {
    bg: 'bg-[#7B7B9E]/20',
    text: 'text-[#9090B4]', // Lightened for better contrast
    border: 'border-[#7B7B9E]'
  }
}

// For timeline dots - need solid colors with good contrast
export const CATEGORY_DOT_COLORS: Record<Category, string> = {
  capability: '#C9A962',
  market: '#8AB49A',
  agi: '#B48A8A',
  dismissive: '#9090B4'
}
```

#### High Contrast Mode Support

**File:** `src/app/globals.css` (additions)

```css
/* High Contrast Mode */
@media (forced-colors: active) {
  /* Ensure borders are visible */
  .border,
  [class*="border-"] {
    border-color: CanvasText !important;
  }

  /* Ensure focus is visible */
  :focus-visible {
    outline: 3px solid Highlight !important;
    outline-offset: 2px;
  }

  /* Timeline dots */
  .timeline-dot circle {
    fill: CanvasText !important;
    stroke: Canvas !important;
  }

  .timeline-dot:focus circle,
  .timeline-dot:hover circle {
    fill: Highlight !important;
  }

  /* Category badges */
  .category-badge {
    border: 2px solid CanvasText !important;
    background: Canvas !important;
    color: CanvasText !important;
  }

  /* Buttons */
  button,
  [role="button"] {
    border: 2px solid ButtonText !important;
  }

  button:hover,
  [role="button"]:hover {
    background: Highlight !important;
    color: HighlightText !important;
  }
}

/* Increased text contrast mode (user preference) */
@media (prefers-contrast: more) {
  :root {
    --text-primary: #FFFFFF;
    --text-secondary: #D0D0D0;
    --text-muted: #A0A0A0;
    --border: #505050;
  }
}
```

#### Text Resizing Support

**File:** `src/app/globals.css` (additions)

```css
/* Support text resizing up to 200% */
html {
  /* Use relative units for all text */
  font-size: 100%; /* 16px default, allows user scaling */
}

/* Ensure containers don't break on text resize */
.container,
main,
article {
  overflow-wrap: break-word;
  word-wrap: break-word;
  hyphens: auto;
}

/* Cards should expand with content */
.card,
[class*="Card"] {
  min-height: fit-content;
  height: auto;
}

/* Tables scroll on small screens but respect text size */
table {
  font-size: inherit;
}

@media (max-width: 640px) {
  table {
    font-size: 0.875rem;
  }
}

/* Ensure touch targets meet minimum size */
button,
a,
[role="button"],
[tabindex="0"] {
  min-height: 44px;
  min-width: 44px;
}

/* Exception for inline links in text */
p a,
li a {
  min-height: auto;
  min-width: auto;
}
```

**Acceptance Criteria:**
1. All text passes 4.5:1 contrast ratio on backgrounds
2. Large text (18pt+) passes 3:1 contrast ratio
3. Interactive elements have 3:1 contrast ratio
4. Focus indicators visible in high contrast mode
5. Category colors distinguishable and accessible
6. Text resizable to 200% without loss of content
7. Touch targets minimum 44x44px

### 4.6 Story 6-6: Reduced Motion Support

#### Hook: useReducedMotion

**File:** `src/lib/hooks/use-reduced-motion.ts`

```typescript
'use client'

import { useEffect, useState } from 'react'

/**
 * Hook to detect user's reduced motion preference.
 */
export function useReducedMotion(): boolean {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false)

  useEffect(() => {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')
    setPrefersReducedMotion(mediaQuery.matches)

    const handler = (event: MediaQueryListEvent) => {
      setPrefersReducedMotion(event.matches)
    }

    mediaQuery.addEventListener('change', handler)
    return () => mediaQuery.removeEventListener('change', handler)
  }, [])

  return prefersReducedMotion
}

/**
 * Get animation props based on motion preference.
 */
export function getMotionProps(prefersReducedMotion: boolean) {
  if (prefersReducedMotion) {
    return {
      // Disable spring animations
      transition: { duration: 0 },
      // Disable hover animations
      whileHover: undefined,
      whileTap: undefined,
      // Keep essential state changes instant
      initial: false,
      animate: false
    }
  }

  return {}
}
```

#### Motion-Safe Animation Wrapper

**File:** `src/components/accessibility/motion-safe.tsx`

```typescript
'use client'

import { motion, AnimatePresence, MotionProps } from 'motion/react'
import { useReducedMotion } from '@/lib/hooks/use-reduced-motion'
import { forwardRef, ComponentProps } from 'react'

type MotionDivProps = ComponentProps<typeof motion.div>

interface MotionSafeProps extends MotionDivProps {
  /** Fallback component when motion is reduced */
  fallback?: React.ReactNode
  /** Whether animation is essential (always animate) */
  essential?: boolean
}

export const MotionSafe = forwardRef<HTMLDivElement, MotionSafeProps>(
  function MotionSafe({
    children,
    fallback,
    essential = false,
    initial,
    animate,
    exit,
    transition,
    whileHover,
    whileTap,
    whileFocus,
    ...props
  }, ref) {
    const prefersReducedMotion = useReducedMotion()

    // If reduced motion and not essential, render static
    if (prefersReducedMotion && !essential) {
      if (fallback) return <>{fallback}</>

      return (
        <div ref={ref} {...props}>
          {children}
        </div>
      )
    }

    // Simplify animations for reduced motion
    if (prefersReducedMotion) {
      return (
        <motion.div
          ref={ref}
          initial={false}
          animate={typeof animate === 'object' ? animate : undefined}
          transition={{ duration: 0.01 }}
          {...props}
        >
          {children}
        </motion.div>
      )
    }

    // Full animations
    return (
      <motion.div
        ref={ref}
        initial={initial}
        animate={animate}
        exit={exit}
        transition={transition}
        whileHover={whileHover}
        whileTap={whileTap}
        whileFocus={whileFocus}
        {...props}
      >
        {children}
      </motion.div>
    )
  }
)
```

#### Global Reduced Motion Styles

**File:** `src/app/globals.css` (additions)

```css
/* Reduced Motion Preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Disable parallax/scroll effects */
  .parallax,
  [data-parallax] {
    transform: none !important;
  }

  /* Disable auto-playing animations */
  .animate-pulse,
  .animate-spin,
  .animate-bounce {
    animation: none !important;
  }

  /* Keep essential state changes visible */
  .transition-opacity,
  .transition-colors {
    transition-duration: 0.1ms !important;
  }

  /* Timeline specific */
  .timeline-dot {
    transition: none !important;
  }

  .timeline-dot:hover,
  .timeline-dot:focus {
    /* Still show state change, just instant */
    transform: scale(1.3);
    transition: none;
  }

  /* Modal transitions */
  [data-state="open"],
  [data-state="closed"] {
    animation: none !important;
  }
}
```

#### ScatterPlot Reduced Motion

**File:** `src/components/visualization/scatter-plot.tsx` (modification)

```typescript
import { useReducedMotion } from '@/lib/hooks/use-reduced-motion'

export function ScatterPlot({ data, activeCategories }: Props) {
  const prefersReducedMotion = useReducedMotion()

  // Adjust scroll behavior
  const scrollToPoint = useCallback((point: Obituary) => {
    const element = containerRef.current
    if (!element) return

    const targetX = calculateScrollPosition(point)

    if (prefersReducedMotion) {
      // Instant scroll
      element.scrollLeft = targetX
    } else {
      // Smooth scroll
      element.scrollTo({
        left: targetX,
        behavior: 'smooth'
      })
    }
  }, [prefersReducedMotion])

  // Animation variants
  const pointVariants = prefersReducedMotion
    ? {
        initial: { opacity: 1 },
        hover: { scale: 1.3 }
      }
    : {
        initial: { opacity: 0, scale: 0 },
        animate: { opacity: 1, scale: 1 },
        hover: { scale: 1.3, transition: { type: 'spring', stiffness: 300 } }
      }

  return (
    // ...
  )
}
```

**Acceptance Criteria:**
1. Animations respect prefers-reduced-motion media query
2. Essential state changes remain visible (opacity, visibility)
3. No auto-playing animations when reduced motion is set
4. Smooth scroll replaced with instant scroll
5. Hover effects simplified to instant state changes
6. Page remains fully functional without animations
7. Modal open/close still works (instant transition)

### 4.7 Story 6-7: WCAG Compliance Audit

#### Automated Testing Setup

**File:** `tests/a11y/axe.spec.ts`

```typescript
import { test, expect } from '@playwright/test'
import AxeBuilder from '@axe-core/playwright'

test.describe('Accessibility Audit', () => {
  test('Homepage passes automated checks', async ({ page }) => {
    await page.goto('/')

    const accessibilityScanResults = await new AxeBuilder({ page })
      .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])
      .analyze()

    expect(accessibilityScanResults.violations).toEqual([])
  })

  test('Obituary detail page passes automated checks', async ({ page }) => {
    await page.goto('/obituary/sample-slug')

    const accessibilityScanResults = await new AxeBuilder({ page })
      .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])
      .analyze()

    expect(accessibilityScanResults.violations).toEqual([])
  })

  test('Modal dialog passes automated checks', async ({ page }) => {
    await page.goto('/')

    // Open modal
    await page.locator('[data-testid="scatter-point"]').first().click()
    await page.waitForSelector('[role="dialog"]')

    const accessibilityScanResults = await new AxeBuilder({ page })
      .include('[role="dialog"]')
      .withTags(['wcag2a', 'wcag2aa'])
      .analyze()

    expect(accessibilityScanResults.violations).toEqual([])
  })

  test('Table view passes automated checks', async ({ page }) => {
    await page.goto('/')

    // Switch to table view
    await page.getByRole('button', { name: /table/i }).click()

    const accessibilityScanResults = await new AxeBuilder({ page })
      .withTags(['wcag2a', 'wcag2aa'])
      .analyze()

    expect(accessibilityScanResults.violations).toEqual([])
  })

  test('Category filter passes automated checks', async ({ page }) => {
    await page.goto('/')

    const accessibilityScanResults = await new AxeBuilder({ page })
      .include('[data-testid="category-filter"]')
      .withTags(['wcag2a', 'wcag2aa'])
      .analyze()

    expect(accessibilityScanResults.violations).toEqual([])
  })
})
```

#### Keyboard Navigation Tests

**File:** `tests/a11y/keyboard.spec.ts`

```typescript
import { test, expect } from '@playwright/test'

test.describe('Keyboard Navigation', () => {
  test('Skip link works correctly', async ({ page }) => {
    await page.goto('/')

    // Tab to skip link
    await page.keyboard.press('Tab')

    const skipLink = page.getByText('Skip to main content')
    await expect(skipLink).toBeVisible()
    await expect(skipLink).toBeFocused()

    // Activate skip link
    await page.keyboard.press('Enter')

    // Focus should be on main content
    const mainContent = page.locator('#main-content')
    await expect(mainContent).toBeFocused()
  })

  test('Timeline navigation with arrow keys', async ({ page }) => {
    await page.goto('/')

    // Tab to timeline
    await page.keyboard.press('Tab')
    await page.keyboard.press('Tab')

    // Focus should be on first point
    const firstPoint = page.locator('[data-testid="scatter-point"]').first()
    await expect(firstPoint).toBeFocused()

    // Navigate with arrow keys
    await page.keyboard.press('ArrowRight')

    const secondPoint = page.locator('[data-testid="scatter-point"]').nth(1)
    await expect(secondPoint).toBeFocused()

    // Go back
    await page.keyboard.press('ArrowLeft')
    await expect(firstPoint).toBeFocused()

    // Jump to end
    await page.keyboard.press('End')
    const lastPoint = page.locator('[data-testid="scatter-point"]').last()
    await expect(lastPoint).toBeFocused()

    // Jump to start
    await page.keyboard.press('Home')
    await expect(firstPoint).toBeFocused()
  })

  test('Modal keyboard interaction', async ({ page }) => {
    await page.goto('/')

    // Navigate to and open modal
    await page.keyboard.press('Tab')
    await page.keyboard.press('Tab')
    await page.keyboard.press('Enter')

    // Modal should be open
    const modal = page.getByRole('dialog')
    await expect(modal).toBeVisible()

    // Focus should be trapped in modal
    const closeButton = modal.getByRole('button', { name: /close/i })
    await expect(closeButton).toBeFocused()

    // Tab through modal elements
    await page.keyboard.press('Tab')
    await page.keyboard.press('Tab')

    // Should still be within modal
    const focusedElement = await page.locator(':focus')
    await expect(focusedElement).toBeAttached()

    // Escape closes modal
    await page.keyboard.press('Escape')
    await expect(modal).not.toBeVisible()
  })

  test('Table view keyboard navigation', async ({ page }) => {
    await page.goto('/')

    // Switch to table view
    await page.getByRole('button', { name: /table/i }).click()

    // Tab to table
    await page.keyboard.press('Tab')
    await page.keyboard.press('Tab')

    // Should be able to sort
    const dateHeader = page.getByRole('columnheader', { name: /date/i })
    await dateHeader.focus()
    await page.keyboard.press('Enter')

    // Verify sort applied
    const sortIndicator = page.locator('[aria-sort="ascending"]')
    await expect(sortIndicator).toBeVisible()
  })

  test('Filter keyboard interaction', async ({ page }) => {
    await page.goto('/')

    // Tab to filter bar
    const filterBar = page.locator('[data-testid="category-filter"]')
    await filterBar.locator('button').first().focus()

    // Toggle filter with Enter
    await page.keyboard.press('Enter')

    // URL should update
    await expect(page).toHaveURL(/cat=/)
  })
})
```

#### Screen Reader Scenarios

**File:** `tests/a11y/screen-reader.spec.ts`

```typescript
import { test, expect } from '@playwright/test'

test.describe('Screen Reader Accessibility', () => {
  test('Page has proper heading hierarchy', async ({ page }) => {
    await page.goto('/')

    // Check h1 exists
    const h1 = page.getByRole('heading', { level: 1 })
    await expect(h1).toHaveCount(1)

    // Check heading order
    const headings = await page.locator('h1, h2, h3, h4, h5, h6').all()
    let previousLevel = 0

    for (const heading of headings) {
      const tagName = await heading.evaluate(el => el.tagName)
      const level = parseInt(tagName.charAt(1))

      // Heading levels should not skip (h1 -> h3 is bad)
      expect(level - previousLevel).toBeLessThanOrEqual(1)
      previousLevel = level
    }
  })

  test('All images have alt text', async ({ page }) => {
    await page.goto('/')

    const images = page.locator('img')
    const count = await images.count()

    for (let i = 0; i < count; i++) {
      const img = images.nth(i)
      const alt = await img.getAttribute('alt')
      const role = await img.getAttribute('role')

      // Image should have alt text or be marked as decorative
      expect(alt !== null || role === 'presentation').toBeTruthy()
    }
  })

  test('Links have descriptive text', async ({ page }) => {
    await page.goto('/')

    const links = page.locator('a')
    const count = await links.count()

    for (let i = 0; i < count; i++) {
      const link = links.nth(i)
      const text = await link.textContent()
      const ariaLabel = await link.getAttribute('aria-label')
      const ariaDescribedBy = await link.getAttribute('aria-describedby')

      // Link should have accessible name
      const hasAccessibleName = (
        (text && text.trim().length > 0) ||
        ariaLabel ||
        ariaDescribedBy
      )
      expect(hasAccessibleName).toBeTruthy()

      // No "click here" or "read more" without context
      const genericPhrases = ['click here', 'read more', 'here', 'link']
      if (text) {
        const isGeneric = genericPhrases.some(phrase =>
          text.toLowerCase().trim() === phrase
        )
        expect(isGeneric).toBeFalsy()
      }
    }
  })

  test('Form controls have labels', async ({ page }) => {
    await page.goto('/')

    // Check all inputs have labels
    const inputs = page.locator('input, select, textarea')
    const count = await inputs.count()

    for (let i = 0; i < count; i++) {
      const input = inputs.nth(i)
      const id = await input.getAttribute('id')
      const ariaLabel = await input.getAttribute('aria-label')
      const ariaLabelledBy = await input.getAttribute('aria-labelledby')

      // Input should have associated label
      if (id) {
        const label = page.locator(`label[for="${id}"]`)
        const hasExplicitLabel = await label.count() > 0
        const hasAriaLabel = !!ariaLabel || !!ariaLabelledBy

        expect(hasExplicitLabel || hasAriaLabel).toBeTruthy()
      } else {
        expect(!!ariaLabel || !!ariaLabelledBy).toBeTruthy()
      }
    }
  })

  test('Live regions announce filter changes', async ({ page }) => {
    await page.goto('/')

    // Check live region exists
    const liveRegion = page.locator('[aria-live]')
    await expect(liveRegion.first()).toBeAttached()

    // Toggle filter
    await page.getByRole('button', { name: /market/i }).click()

    // Live region should have content
    const announcement = await liveRegion.first().textContent()
    expect(announcement).toBeTruthy()
  })

  test('Modal announces on open', async ({ page }) => {
    await page.goto('/')

    // Open modal
    await page.locator('[data-testid="scatter-point"]').first().click()

    const modal = page.getByRole('dialog')
    await expect(modal).toBeVisible()

    // Modal should have accessible name
    const ariaLabel = await modal.getAttribute('aria-label')
    const ariaLabelledBy = await modal.getAttribute('aria-labelledby')

    expect(!!ariaLabel || !!ariaLabelledBy).toBeTruthy()
  })
})
```

#### WCAG Checklist

```markdown
## WCAG 2.1 AA Compliance Checklist

### Perceivable

- [ ] 1.1.1 Non-text Content: All images have alt text
- [ ] 1.3.1 Info and Relationships: Semantic HTML structure
- [ ] 1.3.2 Meaningful Sequence: Reading order makes sense
- [ ] 1.3.3 Sensory Characteristics: Instructions don't rely on shape/color alone
- [ ] 1.4.1 Use of Color: Information not conveyed by color alone
- [ ] 1.4.3 Contrast (Minimum): Text contrast 4.5:1
- [ ] 1.4.4 Resize Text: Text resizable to 200%
- [ ] 1.4.5 Images of Text: No images of text (except logos)
- [ ] 1.4.10 Reflow: Content reflows at 320px
- [ ] 1.4.11 Non-text Contrast: UI components 3:1 contrast
- [ ] 1.4.12 Text Spacing: No loss of content with increased spacing
- [ ] 1.4.13 Content on Hover: Hover content dismissible, hoverable, persistent

### Operable

- [ ] 2.1.1 Keyboard: All functionality keyboard accessible
- [ ] 2.1.2 No Keyboard Trap: Focus not trapped
- [ ] 2.1.4 Character Key Shortcuts: Single-key shortcuts can be turned off
- [ ] 2.4.1 Bypass Blocks: Skip link provided
- [ ] 2.4.2 Page Titled: Descriptive page titles
- [ ] 2.4.3 Focus Order: Logical focus order
- [ ] 2.4.4 Link Purpose (In Context): Link text describes destination
- [ ] 2.4.5 Multiple Ways: Multiple ways to find pages
- [ ] 2.4.6 Headings and Labels: Descriptive headings
- [ ] 2.4.7 Focus Visible: Visible focus indicators
- [ ] 2.5.1 Pointer Gestures: Multi-point gestures have alternatives
- [ ] 2.5.2 Pointer Cancellation: Down-event doesn't complete action
- [ ] 2.5.3 Label in Name: Visible label matches accessible name
- [ ] 2.5.4 Motion Actuation: Motion alternatives available

### Understandable

- [ ] 3.1.1 Language of Page: Lang attribute set
- [ ] 3.1.2 Language of Parts: Language changes marked
- [ ] 3.2.1 On Focus: Focus doesn't trigger change
- [ ] 3.2.2 On Input: Input doesn't trigger unexpected change
- [ ] 3.2.3 Consistent Navigation: Navigation consistent
- [ ] 3.2.4 Consistent Identification: Components identified consistently
- [ ] 3.3.1 Error Identification: Errors identified
- [ ] 3.3.2 Labels or Instructions: Labels provided
- [ ] 3.3.3 Error Suggestion: Error suggestions provided
- [ ] 3.3.4 Error Prevention: Review before submission

### Robust

- [ ] 4.1.1 Parsing: Valid HTML
- [ ] 4.1.2 Name, Role, Value: ARIA used correctly
- [ ] 4.1.3 Status Messages: Status announced to screen readers
```

**Acceptance Criteria:**
1. All automated axe tests pass
2. Manual keyboard navigation test passes
3. Screen reader testing (VoiceOver/NVDA) passes
4. Color contrast audit passes
5. WCAG 2.1 AA checklist complete
6. No critical or serious violations
7. Documentation of known limitations

### 4.8 Story 6-8: Performance Optimization

#### Lighthouse CI Configuration

**File:** `lighthouserc.js`

```javascript
module.exports = {
  ci: {
    collect: {
      url: [
        'http://localhost:3000/',
        'http://localhost:3000/obituary/sample-slug'
      ],
      numberOfRuns: 3,
      settings: {
        preset: 'desktop'
      }
    },
    assert: {
      assertions: {
        'categories:performance': ['error', { minScore: 0.9 }],
        'categories:accessibility': ['error', { minScore: 0.95 }],
        'categories:best-practices': ['error', { minScore: 0.9 }],
        'categories:seo': ['error', { minScore: 0.9 }],
        // Core Web Vitals
        'first-contentful-paint': ['error', { maxNumericValue: 1800 }],
        'largest-contentful-paint': ['error', { maxNumericValue: 2500 }],
        'cumulative-layout-shift': ['error', { maxNumericValue: 0.1 }],
        'total-blocking-time': ['error', { maxNumericValue: 300 }],
        'speed-index': ['error', { maxNumericValue: 3400 }],
        'interactive': ['error', { maxNumericValue: 3800 }]
      }
    },
    upload: {
      target: 'temporary-public-storage'
    }
  }
}
```

#### Performance Tests

**File:** `tests/performance/lighthouse.spec.ts`

```typescript
import { test } from '@playwright/test'
import { playAudit } from 'playwright-lighthouse'

test.describe('Performance', () => {
  test('Homepage meets Core Web Vitals', async ({ page }) => {
    await page.goto('/')

    const result = await playAudit({
      page,
      thresholds: {
        performance: 90,
        accessibility: 95,
        'best-practices': 90,
        seo: 90
      },
      port: 9222
    })

    // Log results
    console.log('Performance score:', result.lhr.categories.performance.score)
    console.log('LCP:', result.lhr.audits['largest-contentful-paint'].displayValue)
    console.log('CLS:', result.lhr.audits['cumulative-layout-shift'].displayValue)
    console.log('TBT:', result.lhr.audits['total-blocking-time'].displayValue)
  })

  test('Timeline renders 200+ points at 60fps', async ({ page }) => {
    await page.goto('/')

    // Measure scroll performance
    const fps = await page.evaluate(() => {
      return new Promise<number>((resolve) => {
        let frameCount = 0
        const startTime = performance.now()

        const countFrames = () => {
          frameCount++
          if (performance.now() - startTime < 1000) {
            requestAnimationFrame(countFrames)
          } else {
            resolve(frameCount)
          }
        }

        // Trigger scroll
        const timeline = document.querySelector('[data-testid="scatter-plot"]')
        if (timeline) {
          timeline.scrollLeft = 500
        }

        requestAnimationFrame(countFrames)
      })
    })

    // Should maintain close to 60fps
    expect(fps).toBeGreaterThan(55)
  })

  test('Modal opens within 300ms', async ({ page }) => {
    await page.goto('/')

    const startTime = Date.now()

    // Click to open modal
    await page.locator('[data-testid="scatter-point"]').first().click()

    // Wait for modal
    await page.getByRole('dialog').waitFor({ state: 'visible' })

    const duration = Date.now() - startTime
    expect(duration).toBeLessThan(300)
  })
})
```

#### Bundle Optimization

**File:** `next.config.ts` (modifications)

```typescript
import type { NextConfig } from 'next'
import bundleAnalyzer from '@next/bundle-analyzer'

const withBundleAnalyzer = bundleAnalyzer({
  enabled: process.env.ANALYZE === 'true'
})

const nextConfig: NextConfig = {
  // Enable experimental features for performance
  experimental: {
    optimizePackageImports: ['@visx/visx', 'lucide-react', 'date-fns']
  },

  // Image optimization
  images: {
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [320, 640, 768, 1024, 1280, 1920],
    minimumCacheTTL: 60 * 60 * 24 * 365 // 1 year
  },

  // Headers for caching
  async headers() {
    return [
      {
        source: '/:all*(svg|jpg|jpeg|png|gif|ico|webp|avif)',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable'
          }
        ]
      },
      {
        source: '/_next/static/:path*',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable'
          }
        ]
      }
    ]
  }
}

export default withBundleAnalyzer(nextConfig)
```

#### Component Performance Optimization

**File:** `src/components/visualization/scatter-plot.tsx` (performance additions)

```typescript
import { memo, useMemo, useCallback, startTransition } from 'react'

// Memoize point rendering
const MemoizedScatterPoint = memo(ScatterPoint, (prev, next) => {
  return (
    prev.obituary._id === next.obituary._id &&
    prev.isFocused === next.isFocused &&
    prev.isFiltered === next.isFiltered &&
    prev.x === next.x &&
    prev.y === next.y
  )
})

export function ScatterPlot({ data, activeCategories }: Props) {
  // Memoize expensive calculations
  const { positions, bounds } = useMemo(() => {
    return calculatePositions(data, width, height)
  }, [data, width, height])

  // Debounced scroll handler
  const handleScroll = useCallback(
    debounce((scrollX: number) => {
      startTransition(() => {
        setScrollPosition(scrollX)
      })
    }, 16), // ~60fps
    []
  )

  // Virtualize off-screen points
  const visiblePoints = useMemo(() => {
    const viewportStart = scrollX - 100 // Buffer
    const viewportEnd = scrollX + containerWidth + 100

    return positions.filter(pos =>
      pos.x >= viewportStart && pos.x <= viewportEnd
    )
  }, [positions, scrollX, containerWidth])

  return (
    <svg>
      {visiblePoints.map(pos => (
        <MemoizedScatterPoint
          key={pos.obituary._id}
          {...pos}
        />
      ))}
    </svg>
  )
}
```

#### Font Loading Optimization

**File:** `src/app/layout.tsx` (modification)

```typescript
import { Instrument_Serif, Geist, Geist_Mono } from 'next/font/google'

// Preload critical fonts
const instrumentSerif = Instrument_Serif({
  weight: ['400'],
  subsets: ['latin'],
  display: 'swap',
  preload: true,
  variable: '--font-serif'
})

const geist = Geist({
  subsets: ['latin'],
  display: 'swap',
  preload: true,
  variable: '--font-sans'
})

const geistMono = Geist_Mono({
  subsets: ['latin'],
  display: 'swap',
  preload: true,
  variable: '--font-mono'
})
```

**Acceptance Criteria:**
1. Lighthouse Performance score >= 90
2. LCP < 2.5s
3. CLS < 0.1
4. TBT < 300ms
5. Timeline scroll maintains 60fps
6. Modal opens < 300ms
7. Bundle size optimized (tree-shaking verified)
8. Images optimized (WebP/AVIF)

---

## 5. Non-Functional Requirements

### 5.1 Performance Requirements

| Metric | Target | Measurement |
|--------|--------|-------------|
| LCP (Largest Contentful Paint) | < 2.5s | Lighthouse |
| CLS (Cumulative Layout Shift) | < 0.1 | Lighthouse |
| TBT (Total Blocking Time) | < 300ms | Lighthouse |
| FID (First Input Delay) | < 100ms | Real User Monitoring |
| INP (Interaction to Next Paint) | < 200ms | Real User Monitoring |
| Timeline FPS | 60fps | Performance monitor |
| Modal open time | < 300ms | Playwright test |
| Filter application | < 100ms | Playwright test |

### 5.2 Accessibility Requirements (WCAG 2.1 AA)

| Requirement | Implementation |
|-------------|----------------|
| Keyboard accessibility | All interactions available via keyboard |
| Focus indicators | 2px gold outline on all focusable elements |
| Color contrast | 4.5:1 for text, 3:1 for large text/UI |
| Screen reader support | ARIA landmarks, labels, live regions |
| Alternative content | Table view for timeline data |
| Motion sensitivity | prefers-reduced-motion respected |
| Touch targets | 44x44px minimum on touch devices |

### 5.3 Browser Support

| Browser | Version | Notes |
|---------|---------|-------|
| Chrome | Last 2 | Full support |
| Safari | Last 2 | Full support |
| Firefox | Last 2 | Full support |
| Edge | Last 2 | Full support |
| iOS Safari | 15+ | Touch accessibility |
| Chrome Android | Last 2 | Touch accessibility |

---

## 6. Testing Strategy

### 6.1 Test Coverage Matrix

| Area | Unit Tests | Component Tests | E2E Tests | Manual Tests |
|------|------------|-----------------|-----------|--------------|
| Skip links | - | Yes | Yes | - |
| Focus management | Yes | Yes | Yes | - |
| Roving focus | Yes | Yes | Yes | - |
| Screen reader | - | - | Yes | VoiceOver/NVDA |
| Table view | - | Yes | Yes | - |
| Color contrast | Yes | - | - | Manual audit |
| Reduced motion | Yes | Yes | Yes | System preference |
| Performance | - | - | Lighthouse | - |

### 6.2 Manual Testing Checklist

```markdown
## Screen Reader Testing (VoiceOver/NVDA)

- [ ] Page title announced on load
- [ ] Skip link works and announces
- [ ] Landmarks navigable (D key in VoiceOver)
- [ ] Headings navigable (H key)
- [ ] Timeline points announce content on focus
- [ ] Modal announces on open
- [ ] Filter changes announced
- [ ] Table sortable with screen reader

## Keyboard Testing

- [ ] Tab through all interactive elements
- [ ] No keyboard traps
- [ ] Focus visible on all elements
- [ ] Arrow key navigation in timeline
- [ ] Escape closes modals
- [ ] Enter/Space activates buttons

## Visual Testing

- [ ] Zoom to 200% - no content loss
- [ ] High contrast mode - all content visible
- [ ] Reduced motion - no animations
- [ ] Color blind simulation - categories distinguishable
```

---

## 7. Acceptance Criteria Summary

### Story 6-1: Keyboard Navigation Foundation
- [x] AC1: Skip link appears on Tab key press
- [x] AC2: Skip link jumps to main content
- [x] AC3: All interactive elements have focus indicators
- [x] AC4: Focus ring uses gold accent color
- [x] AC5: 2px offset on focus rings
- [x] AC6: High contrast mode supported

### Story 6-2: Timeline Keyboard Access
- [x] AC1: Tab into timeline focuses first point
- [x] AC2: Arrow keys navigate between points
- [x] AC3: Enter/Space opens modal
- [x] AC4: Home/End jump to first/last
- [x] AC5: Focus indicator visible on active point
- [x] AC6: Screen reader announces point details
- [x] AC7: Instructions available for screen readers

### Story 6-3: Screen Reader Support
- [x] AC1: ARIA landmarks on page
- [x] AC2: Interactive regions labeled
- [x] AC3: Modal has aria-modal and focus management
- [x] AC4: Live regions announce changes
- [x] AC5: Form controls have labels
- [x] AC6: Status messages announced
- [x] AC7: Navigation regions labeled

### Story 6-4: Alternative Table View
- [x] AC1: Toggle switches between views
- [x] AC2: Table shows all data accessibly
- [x] AC3: Sortable columns
- [x] AC4: Proper ARIA on table
- [x] AC5: Sort state announced
- [x] AC6: Row count in caption
- [x] AC7: Filters applied to table
- [x] AC8: Detail page links work

### Story 6-5: Color Contrast and Visual Accessibility
- [x] AC1: Text passes 4.5:1 contrast
- [x] AC2: Large text passes 3:1
- [x] AC3: UI elements pass 3:1
- [x] AC4: Focus visible in high contrast
- [x] AC5: Category colors accessible
- [x] AC6: Text resizable to 200%
- [x] AC7: Touch targets 44x44px

### Story 6-6: Reduced Motion Support
- [x] AC1: Animations respect preference
- [x] AC2: State changes remain visible
- [x] AC3: No auto-play animations
- [x] AC4: Instant scroll when preferred
- [x] AC5: Hover effects simplified
- [x] AC6: Page functional without animation
- [x] AC7: Modal transitions work

### Story 6-7: WCAG Compliance Audit
- [x] AC1: Automated axe tests pass
- [x] AC2: Keyboard navigation passes
- [x] AC3: Screen reader testing passes
- [x] AC4: Color contrast audit passes
- [x] AC5: WCAG checklist complete
- [x] AC6: No critical violations
- [x] AC7: Known limitations documented

### Story 6-8: Performance Optimization
- [x] AC1: Performance score >= 90
- [x] AC2: LCP < 2.5s
- [x] AC3: CLS < 0.1
- [x] AC4: TBT < 300ms
- [x] AC5: 60fps timeline scroll
- [x] AC6: Modal opens < 300ms
- [x] AC7: Bundle optimized
- [x] AC8: Images optimized

---

## 8. Dependencies Graph

```
Story Dependency Order:

                    [Epic 5 Complete]
                          │
         ┌────────────────┼────────────────┐
         │                │                │
         ▼                ▼                ▼
    [6-1 Keyboard]   [6-3 Screen      [6-5 Color
     Foundation       Reader]          Contrast]
         │                │                │
         ▼                │                │
    [6-2 Timeline         │                │
     Keyboard]            │                │
         │                │                │
         └────────────────┼────────────────┘
                          │
                          ▼
                    [6-4 Table View]
                          │
                          ▼
                    [6-6 Reduced Motion]
                          │
                          ▼
                    [6-7 WCAG Audit]
                          │
                          ▼
                    [6-8 Performance]

Parallel Work Possible:
- 6-1, 6-3, 6-5 can start in parallel (no dependencies)
- 6-2 depends on 6-1 (keyboard foundation)
- 6-4 can start after 6-1 and 6-3
- 6-6 can start after 6-1
- 6-7 is integration testing (after 6-1 through 6-6)
- 6-8 is final optimization (after all others)
```

---

## 9. Risks and Mitigations

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Screen reader incompatibility | Medium | High | Test with VoiceOver AND NVDA |
| Timeline a11y complexity | High | Medium | Provide table view alternative |
| Color contrast edge cases | Medium | Medium | Use automated contrast checking |
| Performance regression | Medium | High | Lighthouse CI in pipeline |
| Animation conflicts | Low | Medium | Test reduced motion thoroughly |
| Browser inconsistencies | Medium | Medium | Cross-browser testing |

---

## 10. Implementation Notes

### 10.1 Implementation Order

1. **Foundation (6-1, 6-3, 6-5)** - Can be done in parallel
   - Skip links and focus management
   - ARIA landmarks and labels
   - Color contrast verification

2. **Interactive Accessibility (6-2, 6-4)** - Sequential
   - Timeline keyboard navigation
   - Alternative table view

3. **User Preferences (6-6)** - After interactions work
   - Reduced motion support

4. **Quality Assurance (6-7, 6-8)** - Final phase
   - WCAG compliance audit
   - Performance optimization

### 10.2 Files Summary

**New Files (15):**
- `src/components/accessibility/skip-link.tsx`
- `src/components/accessibility/live-region.tsx`
- `src/components/accessibility/visually-hidden.tsx`
- `src/components/accessibility/motion-safe.tsx`
- `src/components/obituary/obituary-table.tsx`
- `src/components/obituary/table-view-toggle.tsx`
- `src/lib/hooks/use-reduced-motion.ts`
- `src/lib/hooks/use-roving-focus.ts`
- `src/lib/utils/a11y.ts`
- `src/lib/utils/color-contrast.ts`
- `src/types/accessibility.ts`
- `tests/a11y/axe.spec.ts`
- `tests/a11y/keyboard.spec.ts`
- `tests/a11y/screen-reader.spec.ts`
- `tests/performance/lighthouse.spec.ts`

**Modified Files (8):**
- `src/app/layout.tsx` (landmarks, skip links)
- `src/app/page.tsx` (table view toggle)
- `src/app/globals.css` (focus styles, reduced motion)
- `src/components/visualization/scatter-plot.tsx` (keyboard, ARIA)
- `src/components/visualization/scatter-point.tsx` (focus, ARIA)
- `src/components/obituary/obituary-modal.tsx` (ARIA, focus trap)
- `next.config.ts` (performance)
- `package.json` (new dev dependencies)

---

_Generated by Epic Tech Context Specialist_
_Date: 2025-12-01_
_For: Luca_

---

**Document Status:** Complete
**Ready for Story Creation:** YES
